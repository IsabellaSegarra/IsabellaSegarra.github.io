{
  "hash": "5dbbc7bdf6f9fcae9f9017a664af056d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assessing Potential Species for Marine Aquaculture in West Coast EEZs\"\ndescription: \"Reproducible functions for assessing species for marine aquaculture.\"\ndate: 2025-12-6\ncategories: [MEDS, R, data-viz, Geospatial] #add hyphen for multiple words\nimage: images/image.png\ncitation: # true if no link \n  url: https://isabellasegarra.github.io/posts/marine-aqaculture-blog\ndraft: false\ndraft-mode: linked\nbibliography: references.bib\n---\n\nHave you ever thought about the environmental impact of the food you eat? If you’re anything like me, you may have tried going vegan or vegetarian at some point, hoping to reduce your carbon footprint by cutting out beef and other protein sources often linked to greenhouse gas emissions. While individual choices are important, solutions that are practical and scalable—like *marine aquaculture*—can have a far more direct and meaningful impact on mitigating climate change.\n\n*What is marine aquaculture?*\n\n\"Marine aquaculture refers to the breeding, rearing, and harvesting of aquatic plants and animals. It can take place in the ocean, or on land in tanks and ponds.\" (@NOAA_Fisheries_2025).\n\nTo many, farming in the ocean might sound novel—but it’s actually been a part of life in some regions for thousands of years. The Kwakwaka’wakw, the Indigenous people of the Pacific Northwest Coast, living in northern Vancouver Island and mainland British Columbia, were known for harvesting clams in clam gardens, sustaining their populations for thousands of years (@Groesbeck2014).\n\nAs the demand for seafood increases, reliance soley on wild-caught populations, which has been ins teady decline since the 1980s (@AquariumPacific_MarineAquaculture) is not sustainable. Marine aquaculture has become popular for its use as a more suitable protein option than land-based meat production and wild-caught sources, with some studies showing that marine aquaculture greenhouse gas emissions could be 40% lower than emissions from land-based aquaculture (@ArevaloMartinez2024). It complements current wild fisheries, produces jobs, and can meet the demand for seafood as human populations continue to grow.\n\nAs mentioned by Gentry et.al, limitations to marine aquaculture include ocean depth, marine protected areas, global fishing and shipping lanes, and environmental factors (@Gentry2017). The article mentioned that proper planning is key to successful marine aquaculture. That includes choosing the correct species based on environmental factors and the species' suitability.\n\n## Overview of study\n\nIn this study, I investigated where to prioritize marine aquaculture in the West Coast of the United States within Exclusive Economic Zones (EEZ) for two focal species: **oysters** and **blue mussels**. Exclusive Economic Zones are regions of the ocean that are open for a country to explore. The U.S. West coast has five regions. (@NOAA_EEZ_facts).\n\n\n::: {.cell}\n\n:::\n\n\n## The Data I Used\n\nThe data for this study includes a shapefile for the West Coast EEZ, bathymetry (depth) raster, and sea surface temperature raster.\n\n### Species data\n\nThe two focal species for this study are oysters and blue mussels (*Mytilus edulis*). Both of these bivalve species are found in the Pacific ocean and have the ability to serve as a great protein source for marine aquaculture. I found their depth and temperature requirements from @SeaLifeBase_47622 and @Zagata2008_MytilusEdulis.\n\n![Pacific Oyster](images/pacific_oyster.jpg){width=\"300px\"}\n\n![Blue Mussel](images/o_mytedu.jpg){width=\"300px\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Table 1. Species information</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Species </th>\n   <th style=\"text-align:left;\"> Temperature Range </th>\n   <th style=\"text-align:left;\"> Depth Range </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Oysters </td>\n   <td style=\"text-align:left;\"> 11-30°C </td>\n   <td style=\"text-align:left;\"> 0-70 m </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Blue Mussel </td>\n   <td style=\"text-align:left;\"> 5-20°C </td>\n   <td style=\"text-align:left;\"> 0-60 m </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Sea Surface Temperature Data\nI will use average annual sea surface temperature (SST) from 2008 to 2012. The data is from NOAA's Daily Global Satellite Sea Surface Temperature anomaly @NOAACoralReefWatch_SSTA.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#......Import Sea Surface Temperature Data......\n\n# Read in SST rasters in a raster stack \nsst_fp <- list.files(here(\"posts\", \"marine-aquaculture-blog\", \"data\"), pattern = \"average_annual_sst_\", full.names = TRUE)\n# Stack \nsst <- rast(sst_fp) %>% \n  project(\"EPSG:4326\") # project CRS \n\n# Clear working environment \nrm(list = 'sst_fp')\n```\n:::\n\n\nI will process the sea surface temperature (SST) data in order to combine it with the depth data. The SST data needs to be averaged and converted into Celsius.\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Data Wrangling......\n\n# Find the average sea surface temperature from 2008-2012\navg_sst <- mean(sst)\n\n# Convert average SST from Kelvin to Celsius\navg_sst_c <- avg_sst - 273.15\n\n# Clear working environment\nrm(avg_sst)\n```\n:::\n\n\n### Depth Data\n\nI will use bathymetry data from the General Bathymetric Chart of the Oceans @GEBCO2022.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Import Depth Data......\ndepth <- rast(here(\"posts\", \"marine-aquaculture-blog\", \"data\", \"depth.tif\")) %>% \n  project(\"EPSG:4326\") # project CRS\n```\n:::\n\n\nIn this section, I matched the resolution (number and size of pixels) of depth to match `avg_sst_c`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Crop depth raster......\n\n# Create extent of 'avg_sst_c'\next_sst <- ext(avg_sst_c)\n\n# Crop depth raster to match the extent of the SST raster\ndepth_cropped <- crop(depth, ext_sst)\n\n# Ensure data was cropped \nif(ncell(depth) == ncell(depth_cropped)) {\n  warning(\"data did not crop!\")\n} else {\n  message(\"data cropped!\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ndata cropped!\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Resample......\n\n# Resample to match resolutions \ndepth <- resample(depth_cropped, avg_sst_c, method = \"bilinear\") # method bilinear \n\n# Check that the resolutions match\nif (all(res(depth) == res(avg_sst_c))) {\n  message(\"Resolutions match!\")\n} else {\n  warning(\"Resolutions do not match\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nResolutions match!\n```\n\n\n:::\n\n```{.r .cell-code}\n# Remove 'depth_cropped' from environment\nrm(list = 'depth_cropped')\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......CRS check......\n\n# Check that CRSs match \nif (crs(depth) != crs(avg_sst_c)) {\n  warning(\"Coordinate refrence systems DO NOT match!\")\n} else {\n  message(\"Coordinate refrence systems match!\")\n} \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCoordinate refrence systems match!\n```\n\n\n:::\n:::\n\n\n## Find suitable locations for species\n\nIn this section I will find suitable locations (area in km) that satisfy the specific sea surface temperature and depth range for oysters.\n\n### Reclassificaiton Matrix\n\nIn order to find suitable locations for the oyster, I need to reclassify `avvg_sst_c` and `depth` data into locations that are suitable for oysters. This process returns the cells in the raster that satisfy the criteria.\n\n-   1: suitable locations\n-   0: unsuitable locations\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Reclassification matrix: sea surface temperature......\n\nsst_matrix <- matrix(c(-Inf, 11, 0, # values -Inf to 11 = 0\n                11, 30, 1,  # values 11 to 30 = 1\n                30, Inf, 0), # values 30 to Inf = 0\n              ncol = 3, byrow = TRUE)\n\n# Apply the matrix to reclassify the raster, making all cells 0 or 1\nsst_rcl <- terra::classify(avg_sst_c, rcl = sst_matrix)\n\n\n# Assign Nan values as NA\nvalues(sst_rcl)[is.nan(values(sst_rcl))] <- NA\n\n\n# Ensure SST was reclassified\nif (identical(values(avg_sst_c), values(sst_rcl))) {\n  warning(\"SST not reclassified!\")\n} else {\n  message(\"SST reclassified!\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSST reclassified!\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Reclassification matrix: Depth......\n\ndepth_matrix <- matrix(c(-Inf, -70, 0, # values -Inf to 70 = 0\n                -70, 0, 1,  # values 70 to 0 = 1\n                0, Inf, 0), # values \n              ncol = 3, byrow = TRUE)\n\n\n# Apply the matrix to reclassify the raster, making all cells 0 or 1\ndepth_rcl <- terra::classify(depth, rcl = depth_matrix)\n\n# Ensure depth was reclassified\nif (identical(values(depth), values(depth_rcl))) {\n  warning(\"Depth not reclassified!\")\n} else {\n  message(\"Depth reclassified!\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDepth reclassified!\n```\n\n\n:::\n:::\n\n\nI now have suitable locations for the specific sea surface temperature and depth specifications for oysters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Find suitable locations......\n\n# Multiply reclassification matrices to find suitable locations\n# creates matrix of 0/1 where 0 = not suitable and 1 = suitable \nsuitable_locations <- sst_rcl * depth_rcl \n\n\n# Convert all zeros to NA values\nsuitable_locations[suitable_locations == 0] <- NA\n\n\n# Find the area of suitable locations for oysters \nsuitable_area <- expanse(suitable_locations, unit = \"km\")\n```\n:::\n\n\n## Determine the most suitable EEZ\n\nIn this section, I will determine the total suitable area within each EEZ for oysters. This data is from [Marineregions.org](https://www.marineregions.org/eez.php) @FlandersMarineInstitute_EEZ.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Import Data and Check CRS......\n\n# Import data\neez <- st_read(here(\"posts\", \"marine-aquaculture-blog\", \"data\", \"wc_regions_clean.shp\")) \n\n# Check if CRS match \nif (st_crs(eez) == st_crs(4326)) {\n  message(\"CRS match with depth and average sea surface temperature\")\n} else {\n  warning(\"CRS does not match! Transforming required.\")\n}\n```\n:::\n\n\n### Find suitable areas within West Coast EEZs\n\nIn this section I will find the suitable areas within West Coast EEZs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Apply mask ......\n\n# Mask suitable locations to eez habitat  \neez_cells <- mask(suitable_locations, eez) \n\nif (ncell(suitable_locations) == ncell(eez_cells)) {\n  message(\"Mask worked!\") \n}else {\n  warning(\"Mask did not work\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMask worked!\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Calculate total area ......\n\n# make sure eez and eez cells extent match\nif (ext(eez) == ext(eez_cells)) {\n  message(\"Extents match!\")\n} else {\n  warning(\"Extents don't match! Cropping eez_cells to match eez extent...\")\n  eez_cells <- crop(eez_cells, ext(eez))\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Extents don't match! Cropping eez_cells to match eez extent...\n```\n\n\n:::\n\n```{.r .cell-code}\n# Calculate cell size area of each raster cell\neez_cells_area <- cellSize(eez_cells, unit = \"km\")\n\n#......Find total area......\n\n# Rasterize eez\nrast_eez <- rasterize(eez, eez_cells, field = \"rgn_id\")\n\n# perform zonal operation \narea_by_eez<- zonal(x = eez_cells_area * eez_cells, z = rast_eez, fun = \"sum\", na.rm = TRUE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#......Join data......\n\neez_suitable_locations <- area_by_eez %>%\n  left_join(eez, by = \"rgn_id\")\n\n# clean up data frame\n\neez_suitable_locations <- eez_suitable_locations %>% \n  rename(area_suitable_km = area) %>% # rename area\n  select(rgn, area_suitable_km, geometry) # select for region, area, and geometry to plot \n\n#.....Convert to sf object....\neez_suitable_locations <- st_as_sf(eez_suitable_locations)\n```\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Table 2. Suitable Area for Oysters</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Regions </th>\n   <th style=\"text-align:right;\"> Suitable Habitat (km) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Oregon </td>\n   <td style=\"text-align:right;\"> 1028.886 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern California </td>\n   <td style=\"text-align:right;\"> 194.126 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Central California </td>\n   <td style=\"text-align:right;\"> 3655.923 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern California </td>\n   <td style=\"text-align:right;\"> 3098.006 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Washington </td>\n   <td style=\"text-align:right;\"> 2421.627 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Map: Oyster Suitable Area\n\nNow I will map the suitable locations for oyster marien aquaculture.\n\n\n::: {.cell}\n\n```{.r .cell-code}\noyster_map <-\n  tm_basemap(\"Esri.WorldImagery\") +\ntm_shape(eez_suitable_locations) +\n  tm_polygons(fill = \"area_suitable_km\" , # fill polygons based on suitable area \n              style = \"cont\", # continuous value scale \n    palette = c(\"#9ef7f0\", \"#1d524d\"), # palette of colors \n    title = \"Suitable habitat (km²)\", size = 0.8) + # legend title \n  tm_layout(legend.outside = TRUE, \n            legend.text.size = 0.5) +\n  tm_title(paste(\"Suitable Habitat Range For\", \"Oyster Aquaculture\", sep = \"\\n\"), size = 1)  +\n  tm_graticules(lwd = 0.2) + # gridlines \n  tm_scalebar(position = c(\"left\", \"bottom\"), text.size = 0.3)+ #scalebar \n  tm_text(\"rgn\", # overlay text for region\n          size = 0.4,  \n          xmod = -0.2,\n  ymod = 0.3)\n                \n# View map\noyster_map \n```\n\n::: {.cell-output-display}\n![](marine-aquaculture_files/figure-html/oyster map-1.png){width=672}\n:::\n:::\n\n\nThe map above depicts the suitable locations for oyster aquaculture within West Coast EEZs. As you can see, the regions with the most suitable habitat are Central and Southern California.\n\n## Generalizable function\n\nNow that I have a worfklow for determining the suitable locations for oysters, I will create a generalizable function that can be applied to any species of interest. I will test this function for my second focal species **blue mussels**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define function name and arguments \nsuitability_fun <- function(sst_min, sst_max, depth_min, depth_max, species) {\n  \n# 1. Reclassification matrices \n  \n  # Define SST reclassification matrix \n  sst_matrix <- matrix(\n    c(\n      -Inf,  sst_min, 0,   # below min sst = 0/unsuitable\n       sst_min, sst_max, 1, # range of sst = 1/suitable\n       sst_max, Inf,    0   # above max sst = 0/unsuitable\n    ),\n    ncol = 3, byrow = TRUE\n  )\n\n  # Define Depth reclassification matrix \ndmin <- min(depth_min, depth_max) # ensure depth min is the smaller depth\ndmax <- max(depth_min, depth_max) \n\ndepth_matrix <- matrix(\n  c(-Inf, -dmax, 0,\n    -dmax, -dmin, 1,\n    -dmin, Inf, 0),\n  ncol = 3, byrow = TRUE\n)\n  \n# 2. Reclassify SST and Depth data \n  \n  # Reclassify SST \n  sst_rcl <- terra::classify(avg_sst_c, rcl = sst_matrix)\n  # Fill NAN values with NAs \n  values(sst_rcl)[is.nan(values(sst_rcl))] <- NA\n\n  # Reclassify depth \n  depth_rcl <- terra::classify(depth, rcl = depth_matrix)\n  \n# 3. Find suitable locations\n  # Multiply reclassifications to create matrix of 0/1\n  suitable_locations <- sst_rcl * depth_rcl\n\n  # Convert zeros to NAs\n  suitable_locations[suitable_locations == 0] <- NA\n\n  # Apply mask to keep only suitable raster cells in eez \n  eez_cells <- mask(suitable_locations, eez)\n  \n  # Find cell area\n  eez_cells_area <- cellSize(eez_cells, unit = \"km\")\n\n# 4. Zonal operation\n  \n  # Rasterize eez\nrast_eez <- rasterize(eez, eez_cells, field = \"rgn_id\")\n\n  # perform zonal operation \narea_by_eez<- zonal(x = eez_cells_area * eez_cells, z = rast_eez, fun = \"sum\", na.rm = TRUE)\n\n# 5. Join data \n\neez_suitable_locations <- area_by_eez %>%\n  left_join(eez, by = \"rgn_id\") %>% # join on 'rgn_id'\n  rename(area_suitable_km = area) %>% # rename column\n  select(rgn, area_suitable_km, geometry) # select certain columns for df\n\n# 6. Convert to sf object\neez_suitable_locations <- st_as_sf(eez_suitable_locations)\n  \n\n# 7.  Create map \n  \nspecies_map <-\ntm_basemap(\"Esri.WorldImagery\") +\ntm_shape(eez_suitable_locations) +\n  tm_polygons(fill = \"area_suitable_km\" , # fill polygons based on suitable area \n              style = \"cont\", # continuous value scale \n    palette = c(\"#9ef7f0\", \"#1d524d\"), # palette of colors \n    title = \"Suitable habitat (km²)\", size = 0.8) + # legend title \n  tm_layout(legend.outside = TRUE, \n            legend.text.size = 0.5) +\n  tm_title(paste(\"Suitable Habitat Range For\", \"\\n\", \"Blue Mussel Marine Aquaculture\"), size = 1) +\n  tm_graticules(lwd = 0.2) + # gridlines \n  tm_scalebar(position = c(\"left\", \"bottom\"), text.size = 0.3)+ #scalebar \n  tm_text(\"rgn\", # overlay text for region\n          size = 0.4,  \n          xmod = -0.2,\n  ymod = 0.3)\n\n\n# return species map and table of eez suitable area \nreturn(species_map) \n\n}\n```\n:::\n\n\n## Apply function: Blue Mussels\n\nIn this section I will apply the `suitability_fun` function to my second focal species **blue mussels**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuitability_fun(\n  sst_min = 5, # define min stt value\n  sst_max = 20, # define max sst value\n  depth_min = 0, # define min depth value\n  depth_max = 60, # define max depth value \n  species = \"Blue Mussel\" # define species name \n)\n```\n\n::: {.cell-output-display}\n![](marine-aquaculture_files/figure-html/Blue mussels function-1.png){width=672}\n:::\n:::\n\n\n*Reflection*: The map above depicts the suitable locations for blue mussel aquaculture within West Coast EEZs. As you can see, the regions with the most suitable habitat are Washington. The rest of the California and Oregon coast contain less suitable locations probably due to the temperature range for blue mussels, who prefer colder temperatures.\n\n## Final Thoughts\n\nThis project investigated the suitable habitats for two focal species --oyster and blue mussel-- for marine aquaculture in West Coast Economic Exclusive Zones. Although I only mapped two species, the function `suitability_fun` can be used on a variety of species of interest for marine aquaculture. This analysis provides insight into the work needed to plan for marine aquaculture sites. Although I only include sea surface temperature and depth as specifications for suitability, as mentioned in Gentry et.al, there are many more factors that are of importance for assessing suitability of species. Additionally, as sea surface temperatures continue to rise due to climate change, the suitability for these species may alter.\n\n- mention the average of 2008 to 2012 (narrow time range, out of scope)\n",
    "supporting": [
      "marine-aquaculture_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}